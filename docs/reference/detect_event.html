<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Detect heatwaves and cold-spells. — detect_event • heatwaveR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Detect heatwaves and cold-spells. — detect_event"><meta property="og:description" content="Applies the Hobday et al. (2016) marine heat wave definition to an input time
series of a given value (usually, but not necessarily limited to, temperature)
along with a daily date vector and pre-calculated seasonal and threshold
climatologies, which may either be created with ts2clm or some
other means."><meta property="og:image" content="https://robwschlegel.github.io/heatwaveR/index.html/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118123016-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118123016-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heatwaveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/detection_and_visualisation.html">Basic Detection and Visualisation of Events</a>
    </li>
    <li>
      <a href="../articles/event_categories.html">Calculating and Visualising Event Categories</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Calculating and Visualising Exceedances</a>
    </li>
    <li>
      <a href="../articles/complex_clims.html">Alternative Thresholds</a>
    </li>
    <li>
      <a href="../articles/MHW_metric_trends.html">Trend and Breakpoint Analyses</a>
    </li>
    <li>
      <a href="../articles/OISST_preparation.html">Downloading and Preparing OISST Data</a>
    </li>
    <li>
      <a href="../articles/gridded_event_detection.html">Detecting Events in Gridded Data</a>
    </li>
    <li>
      <a href="../articles/Download_SST_v2.html">Download, Prepare, and Analyse Data: Alternative</a>
    </li>
    <li>
      <a href="../articles/MHW_to_nc.html">Saving MHW Results to NetCDF</a>
    </li>
  </ul></li>
<li>
  <a href="http://193.50.85.71:3838/demoMHW/" class="external-link">Tutorial</a>
</li>
<li>
  <a href="../CITATIONS.html">Citations</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/robwschlegel/heatwaveR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect heatwaves and cold-spells.</h1>
    <small class="dont-index">Source: <a href="https://github.com/robwschlegel/heatwaveR/blob/HEAD/R/detect_event.R" class="external-link"><code>R/detect_event.R</code></a></small>
    <div class="hidden name"><code>detect_event.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Applies the Hobday et al. (2016) marine heat wave definition to an input time
series of a given value (usually, but not necessarily limited to, temperature)
along with a daily date vector and pre-calculated seasonal and threshold
climatologies, which may either be created with <code><a href="ts2clm.html">ts2clm</a></code> or some
other means.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_event</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  x <span class="op">=</span> <span class="va">t</span>,</span>
<span>  y <span class="op">=</span> <span class="va">temp</span>,</span>
<span>  seasClim <span class="op">=</span> <span class="va">seas</span>,</span>
<span>  threshClim <span class="op">=</span> <span class="va">thresh</span>,</span>
<span>  threshClim2 <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  minDuration <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  minDuration2 <span class="op">=</span> <span class="va">minDuration</span>,</span>
<span>  joinAcrossGaps <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  maxGap <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  maxGap2 <span class="op">=</span> <span class="va">maxGap</span>,</span>
<span>  coldSpells <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  protoEvents <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  categories <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  roundRes <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame with at least four columns. In the default setting
(i.e. omitting the arguments <code>x</code>, <code>y</code>, <code>seas</code>, and <code>thresh</code>;
see immediately below), the data set is expected to have the headers <code>t</code>,
<code>temp</code>, <code>seas</code>, and <code>thresh</code>. The <code>t</code>
column is a vector of dates of class <code>Date</code>, <code>temp</code> is the measured
variable (by default it is assumed to be temperature), <code>seas</code> is the seasonal
cycle daily climatology (366 days), and <code>thresh</code> is the seasonal cycle
daily threshold above which events may be detected. Data of the appropriate
format are created by the function <code><a href="ts2clm.html">ts2clm</a></code>, but your own data
can be supplied if they meet the criteria specified by <code><a href="ts2clm.html">ts2clm</a></code>.
If the column names of <code>data</code> match those outlined here, the following
four arguments may be ignored.</p></dd>


<dt>x</dt>
<dd><p>This column is expected to contain a vector of dates as per the
specification of <code><a href="ts2clm.html">ts2clm</a></code>. If a column headed <code>t</code> is present in
the dataframe, this argument may be omitted; otherwise, specify the name of
the column with dates here.</p></dd>


<dt>y</dt>
<dd><p>This is a column containing the measurement variable. If the column
name differs from the default (i.e. <code>temp</code>), specify the name here.</p></dd>


<dt>seasClim</dt>
<dd><p>The dafault for this argument assumes that the seasonal
climatology column is called <code>seas</code> as this matches the output of
<code><a href="ts2clm.html">ts2clm</a></code>. If the column name for the seasonal climatology is
different, provide that here.</p></dd>


<dt>threshClim</dt>
<dd><p>The threshold climatology column should be called
<code>thresh</code>. If it is not, provide the name of the threshold column here.</p></dd>


<dt>threshClim2</dt>
<dd><p>If one wishes to provide a second climatology threshold
filter for the more rigorous detection of events, a vector or column containing
logical values (i.e. TRUE FALSE) should be provided here. By default this
argument is ignored. It's primary purpose is to allow for the inclusion of
tMin and tMax thresholds.</p></dd>


<dt>minDuration</dt>
<dd><p>The minimum duration for acceptance of detected events.
The default is <code>5</code> days.</p></dd>


<dt>minDuration2</dt>
<dd><p>The minimum duration for acceptance of events after
filtering by <code>threshClim</code> and <code>threshClim</code>. By default
<code>minDuration2 = minDuration</code> and is ignored if <code>threshClim2</code> has not
been specified.</p></dd>


<dt>joinAcrossGaps</dt>
<dd><p>Boolean switch indicating whether to join events which
occur before/after a short gap as specified by <code>maxGap</code>. The default
is <code>TRUE</code>.</p></dd>


<dt>maxGap</dt>
<dd><p>The maximum length of gap allowed for the joining of MHWs. The
default is <code>2</code> days.</p></dd>


<dt>maxGap2</dt>
<dd><p>The maximum gap length after applying both thresholds.
By default <code>maxGap2 = maxGap</code> and is ignored if <code>threshClim2</code> has not
been specified.</p></dd>


<dt>coldSpells</dt>
<dd><p>Boolean specifying if the code should detect cold events
instead of warm events. The default is <code>FALSE</code>. Please note that the
climatological thresholds for cold-spells are considered to be the inverse
of those for MHWs. For example, the default setting for the detection of
MHWs is <code>pctile = 90</code>, as seen in <code><a href="ts2clm.html">ts2clm</a></code>. Should one want
to use <code>detect_event</code> for MCSs, this threshold would best be generated
in <code><a href="ts2clm.html">ts2clm</a></code> by setting <code>pctile = 10</code> (see example below).
Any value may be used, but this is the setting used for the calculation of
MCSs in Schlegel et al. (2017a).</p></dd>


<dt>protoEvents</dt>
<dd><p>Boolean specifying whether the original time series will be
returned with only the columns indicating whether or not the threshold criterion
(<code>threshCriterion</code>) and duration criterion (<code>durationCriterion</code>)
have been exceeded, a column showing if a heatwave is present (i.e. both
<code>threshCriterion</code> and <code>durationCriterion</code> <code>TRUE</code>), and a
sequential number uniquely identifying the detected event(s). Therefore any heatwave
metrics will not be reported. The default is <code>FALSE</code>. Note also that if
<code>protoEvents = TRUE</code> it will ignore whatever the user provides to the <code>categories</code>
argument and anything else passed to <code>...</code>.</p></dd>


<dt>categories</dt>
<dd><p>Rather than using <code><a href="category.html">category</a></code> as a separate step to determine
the categories of the detected MHWs, one may choose to set this argument to <code>TRUE</code>.
One may pass the same arguments used in the <code><a href="category.html">category</a></code> function to this function
to affect the output. Note that the default behaviour of <code><a href="category.html">category</a></code> is to
return the event data only. To return the same list structure that <code>detect_event</code>
outputs by default, use <code>climatology = TRUE</code>.</p></dd>


<dt>roundRes</dt>
<dd><p>This argument allows the user to choose how many decimal places
the MHW metric outputs will be rounded to. Default is 4. To
prevent rounding set <code>roundRes = FALSE</code>. This argument may only be given
numeric values or FALSE.</p></dd>


<dt>...</dt>
<dd><p>Other arguments that will be passed internally to <code><a href="category.html">category</a></code>
when <code>categories = TRUE</code>. See the documentation for <code><a href="category.html">category</a></code> for the
list of possible arguments.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function will return a list of two data.frames,
<code>climatology</code> and <code>event</code>, which are, surprisingly, the climatology
and event results, respectively. The climatology contains the full time series of
daily temperatures, as well as the the seasonal climatology, the threshold
and various aspects of the events that were detected. The software was
designed for detecting extreme thermal events, and the units specified below
reflect that intended purpose. However, various other kinds of extreme
events may be detected according to the specifications, and if that is the
case, the appropriate units need to be determined by the user.</p>


<p>The <code>climatology</code> results will contain the same column produced by
<code><a href="ts2clm.html">ts2clm</a></code> as well as the following:</p>
<dl><dt>threshCriterion</dt>
<dd><p>Boolean indicating if <code>temp</code> exceeds
  <code>thresh</code>.</p></dd>

  <dt>durationCriterion</dt>
<dd><p>Boolean indicating whether periods of consecutive
  <code>threshCriterion</code> are &gt;= <code>min_duration</code>.</p></dd>

  <dt>event</dt>
<dd><p>Boolean indicating if all criteria that define an extreme event
  are met.</p></dd>

  <dt>event_no</dt>
<dd><p>A sequential number indicating the ID and order of
  occurrence of the events.</p></dd>

  <dt>intensity</dt>
<dd><p>The difference between <code>temp</code> (or whichever column is provided
  for <code>y</code>) and <code>seas</code>. Only added if <code>categories = TRUE</code>
  and <code>climatology = TRUE</code>.</p></dd>

  <dt>category</dt>
<dd><p>The category classification per day. Only added
  if <code>categories = TRUE</code> and <code>climatology = TRUE</code>.</p></dd>


</dl><p>The <code>event</code> results are summarised using a range of event metrics:</p>
<dl><dt>event_no</dt>
<dd><p>A sequential number indicating the ID and order of
  the events.</p></dd>

  <dt>index_start</dt>
<dd><p>Start index of event.</p></dd>

  <dt>index_end</dt>
<dd><p>End index of event.</p></dd>

  <dt>duration</dt>
<dd><p>Duration of event [days].</p></dd>

  <dt>date_start</dt>
<dd><p>Start date of event [date].</p></dd>

  <dt>date_end</dt>
<dd><p>End date of event [date].</p></dd>

  <dt>date_peak</dt>
<dd><p>Date of event peak [date].</p></dd>

  <dt>intensity_mean</dt>
<dd><p>Mean intensity [deg. C].</p></dd>

  <dt>intensity_max</dt>
<dd><p>Maximum (peak) intensity [deg. C].</p></dd>

  <dt>intensity_var</dt>
<dd><p>Intensity variability (standard deviation) [deg. C].</p></dd>

  <dt>intensity_cumulative</dt>
<dd><p>Cumulative intensity [deg. C x days].</p></dd>

  <dt>rate_onset</dt>
<dd><p>Onset rate of event [deg. C / day].</p></dd>

  <dt>rate_decline</dt>
<dd><p>Decline rate of event [deg. C / day].</p></dd>

  <dt>event_name</dt>
<dd><p>The name of the event. Generated from the <code><a href="https://rdrr.io/r/base/name.html" class="external-link">name</a></code>
  value provided and the year of the <code>date_peak</code> of
  the event. If no <code><a href="https://rdrr.io/r/base/name.html" class="external-link">name</a></code> value is provided the default "Event" is used.
  As proposed in Hobday et al. (2018), <code>Moderate</code> events are not given a name
  so as to prevent multiple repeat names within the same year. If two or more events
  ranked greater than Moderate are reported within the same year, they will be
  differentiated with the addition of a trailing letter
  (e.g. Event 2001a, Event 2001b). Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>category</dt>
<dd><p>The maximum category threshold reached/exceeded by the event.
  Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>p_moderate</dt>
<dd><p>The proportion of the total duration (days) spent at or above
  the first threshold, but below any further thresholds. Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>p_strong</dt>
<dd><p>The proportion of the total duration (days) spent at or above
  the second threshold, but below any further thresholds. Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>p_severe</dt>
<dd><p>The proportion of the total duration (days) spent at or above
  the third threshold, but below the fourth threshold. Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>p_extreme</dt>
<dd><p>The proportion of the total duration (days) spent at or above
  the fourth and final threshold. Only added if <code>categories = TRUE</code>.</p></dd>

  <dt>season</dt>
<dd><p>The season(s) during which the event occurred. If the event
  occurred across two seasons this will be displayed as e.g. "Winter/Spring".
  Across three seasons as e.g. "Winter-Summer". Events lasting across four or more
  seasons are listed as "Year-round". December (June) is used here as the start of
  Austral (Boreal) summer. If "start", "peak", or "end" was given to the <code>season</code>
  argument then only the one season during that chosen period will be given.
  Only added if <code>categories = TRUE</code>.</p></dd>


</dl><p><code>intensity_max_relThresh</code>, <code>intensity_mean_relThresh</code>,
<code>intensity_var_relThresh</code>, and <code>intensity_cumulative_relThresh</code></p>


<p>are as above except relative to the threshold (e.g., 90th percentile) rather
than the seasonal climatology.</p>


<p><code>intensity_max_abs</code>, <code>intensity_mean_abs</code>, <code>intensity_var_abs</code>, and
<code>intensity_cumulative_abs</code> are as above except as absolute magnitudes
rather than relative to the seasonal climatology or threshold.</p>


<p>Note that <code>rate_onset</code> and <code>rate_decline</code> will return <code>NA</code></p>


<p>when the event begins/ends on the first/last day of the time series. This
may be particularly evident when the function is applied to large gridded
data sets. Although the other metrics do not contain any errors and
provide sensible values, please take this into account in its
interpretation.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<ol><li><p>This function assumes that the input time series consists of continuous
daily values with few missing values. Time ranges which start and end
part-way through the calendar year are supported. The accompanying function
<code><a href="ts2clm.html">ts2clm</a></code> aids in the preparation of a time series that is
suitable for use with <code>detect_event</code>, although this may also be accomplished
'by hand' as long as the criteria are met as discussed in the documentation
to <code><a href="ts2clm.html">ts2clm</a></code>.</p></li>
<li><p>The calculation of onset and decline rates assumes that the events
started a half-day before the start day and ended a half-day after the
end-day. This is consistent with the duration definition as implemented,
which assumes duration = end day - start day + 1. An event that is already
present at the beginning of a time series, or an event that is still present
at the end of a time series, will report the rate of onset or the rate of
decline as <code>NA</code>, as it is impossible to know what the temperature half a
day before or after the start or end of the event is.</p></li>
<li><p>For the purposes of event detection, any missing temperature values not
interpolated over (through optional <code>maxPadLength</code> in <code><a href="ts2clm.html">ts2clm</a></code>)
will be set equal to the seasonal climatology. This means they will trigger
the end/start of any adjacent temperature values which satisfy the event
definition criteria.</p></li>
<li><p>If the code is used to detect cold events (<code>coldSpells = TRUE</code>),
then it works just as for heat waves except that events are detected as
deviations below the (100 - pctile)th percentile (e.g., the 10th instead of
90th) for at least 5 days. Intensities are reported as negative values and
represent the temperature anomaly below climatology.</p></li>
</ol><p>The original Python algorithm was written by Eric Oliver, Institute for
Marine and Antarctic Studies, University of Tasmania, Feb 2015, and is
documented by Hobday et al. (2016). The marine cold spell option was
implemented in version 0.13 (21 Nov 2015) of the Python module as a result
of our preparation of Schlegel et al. (2017), wherein the cold events
receive a brief overview.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hobday, A.J. et al. (2016). A hierarchical approach to defining
marine heatwaves, Progress in Oceanography, 141, pp. 227-238,
doi:10.1016/j.pocean.2015.12.014</p>
<p>Schlegel, R. W., Oliver, C. J., Wernberg, T. W., Smit, A. J. (2017).
Nearshore and offshore co-occurrences of marine heatwaves and cold-spells.
Progress in Oceanography, 151, pp. 189-205, doi:10.1016/j.pocean.2017.01.004</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Albertus J. Smit, Robert W. Schlegel, Eric C. J. Oliver</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res_clim</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_WA</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1983-01-01"</span>, <span class="st">"2012-12-31"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="va">res_clim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># show a portion of the climatology:</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">climatology</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    doy          t  temp    seas  thresh threshCriterion durationCriterion event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 1982-01-01 20.94 21.6080 22.9605           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2 1982-01-02 21.25 21.6348 22.9987           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3 1982-01-03 21.38 21.6621 23.0376           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4 1982-01-04 21.16 21.6895 23.0771           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5 1982-01-05 21.26 21.7169 23.1130           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    6 1982-01-06 21.61 21.7436 23.1460           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    7 1982-01-07 21.74 21.7699 23.1775           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    8 1982-01-08 21.50 21.7958 23.2080           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    9 1982-01-09 21.40 21.8217 23.2366           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  10 1982-01-10 21.36 21.8478 23.2649           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    event_no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       NA</span>
<span class="r-in"><span><span class="co"># show some of the heat waves:</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">event</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   event_no index_start index_peak index_end duration date_start  date_peak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        1         885        887       889        5 1984-06-03 1984-06-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        2         899        901       904        6 1984-06-17 1984-06-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        3         908        922       926       19 1984-06-26 1984-07-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        4        1023       1027      1029        7 1984-10-19 1984-10-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        5        1033       1034      1037        5 1984-10-29 1984-10-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     date_end intensity_mean intensity_max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1984-06-07         1.7042        1.9218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1984-06-22         1.9851        2.1063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1984-07-14         1.9094        2.2165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1984-10-25         1.4626        1.8304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1984-11-02         1.3034        1.4887</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or if one wants to calculate MCSs</span></span></span>
<span class="r-in"><span><span class="va">res_clim</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_WA</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1983-01-01"</span>, <span class="st">"2012-12-31"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   pctile <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="va">res_clim</span>, coldSpells <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># show a portion of the climatology:</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">climatology</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    doy          t  temp    seas  thresh threshCriterion durationCriterion event</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 1982-01-01 20.94 21.6080 20.5471           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2 1982-01-02 21.25 21.6348 20.5713           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3 1982-01-03 21.38 21.6621 20.5961           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4 1982-01-04 21.16 21.6895 20.6218           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5 1982-01-05 21.26 21.7169 20.6499           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    6 1982-01-06 21.61 21.7436 20.6776           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    7 1982-01-07 21.74 21.7699 20.7053           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    8 1982-01-08 21.50 21.7958 20.7362           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    9 1982-01-09 21.40 21.8217 20.7655           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  10 1982-01-10 21.36 21.8478 20.7927           FALSE             FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    event_no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       NA</span>
<span class="r-in"><span><span class="co"># show some of the cold-spells:</span></span></span>
<span class="r-in"><span><span class="va">out</span><span class="op">$</span><span class="va">event</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   event_no index_start index_peak index_end duration date_start  date_peak</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        1          83         83        87        5 1982-03-24 1982-03-24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        2         194        199       207       14 1982-07-13 1982-07-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        3         270        272       277        8 1982-09-27 1982-09-29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        4         296        303       306       11 1982-10-23 1982-10-30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        5         672        681       685       14 1983-11-03 1983-11-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     date_end intensity_mean intensity_max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1982-03-28        -1.4543       -1.5877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1982-07-26        -1.8033       -2.7304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1982-10-04        -1.2378       -1.3891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1982-11-02        -1.0167       -1.2813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1983-11-16        -1.1806       -1.4954</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is also possible to calculate the categories of events directly</span></span></span>
<span class="r-in"><span><span class="co"># See the \code{\link{category}} documentation for more functionality</span></span></span>
<span class="r-in"><span><span class="va">res_clim</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_WA</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1983-01-01"</span>, <span class="st">"2012-12-31"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_event</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="va">res_clim</span>, categories <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_list</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="va">res_clim</span>, categories <span class="op">=</span> <span class="cn">TRUE</span>, climatology <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is also possible to give two separate sets of threshold criteria</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To use a second static threshold we first use the exceedance function</span></span></span>
<span class="r-in"><span><span class="va">thresh_19</span> <span class="op">&lt;-</span> <span class="fu"><a href="exceedance.html">exceedance</a></span><span class="op">(</span><span class="va">sst_Med</span>, threshold <span class="op">=</span> <span class="fl">19</span>, minDuration <span class="op">=</span> <span class="fl">10</span>, maxGap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">threshold</span></span></span>
<span class="r-in"><span><span class="co"># Then we use that output when detecting our events</span></span></span>
<span class="r-in"><span><span class="va">events_19</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_Med</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         threshClim2 <span class="op">=</span> <span class="va">thresh_19</span><span class="op">$</span><span class="va">exceedance</span>, minDuration2 <span class="op">=</span> <span class="fl">10</span>, maxGap2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If we want to use two different percentile thresholds we use detect_event</span></span></span>
<span class="r-in"><span><span class="va">thresh_95</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_Med</span>, pctile <span class="op">=</span> <span class="fl">95</span>,</span></span>
<span class="r-in"><span>                                 climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          minDuration <span class="op">=</span> <span class="fl">2</span>, maxGap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">climatology</span></span></span>
<span class="r-in"><span><span class="co"># Then we use that output when detecting our events</span></span></span>
<span class="r-in"><span><span class="va">events_95</span> <span class="op">&lt;-</span> <span class="fu">detect_event</span><span class="op">(</span><span class="fu"><a href="ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_Med</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          threshClim2 <span class="op">=</span> <span class="va">thresh_95</span><span class="op">$</span><span class="va">event</span>, minDuration2 <span class="op">=</span> <span class="fl">2</span>, maxGap2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert W. Schlegel, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2edc7627dae0471f3d765c3355bebbf3',
    indexName: 'heatwaver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

