<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Detect consecutive days in exceedance above or below of a given threshold. — exceedance • heatwaveR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Detect consecutive days in exceedance above or below of a given threshold. — exceedance"><meta property="og:description" content="Detect consecutive days in exceedance above or below of a given threshold."><meta property="og:image" content="https://robwschlegel.github.io/heatwaveR/index.html/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118123016-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118123016-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heatwaveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.2.9009</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/detection_and_visualisation.html">Basic Detection and Visualisation of Events</a>
    </li>
    <li>
      <a href="../articles/event_categories.html">Calculating and Visualising Event Categories</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Calculating and Visualising Exceedances</a>
    </li>
    <li>
      <a href="../articles/complex_clims.html">Alternative Thresholds</a>
    </li>
    <li>
      <a href="../articles/MHW_metric_trends.html">Trend and Breakpoint Analyses</a>
    </li>
    <li>
      <a href="../articles/OISST_preparation.html">Downloading and Preparing OISST Data</a>
    </li>
    <li>
      <a href="../articles/gridded_event_detection.html">Detecting Events in Gridded Data</a>
    </li>
    <li>
      <a href="../articles/Download_SST_v2.html">Download, Prepare, and Analyse Data: Alternative</a>
    </li>
    <li>
      <a href="../articles/MHW_to_nc.html">Saving MHW Results to NetCDF</a>
    </li>
  </ul></li>
<li>
  <a href="http://193.50.85.71:3838/demoMHW/" class="external-link">Tutorial</a>
</li>
<li>
  <a href="../CITATIONS.html">Citations</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/robwschlegel/heatwaveR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect consecutive days in exceedance above or below of a given threshold.</h1>
    <small class="dont-index">Source: <a href="https://github.com/robwschlegel/heatwaveR/blob/HEAD/R/exceedance.R" class="external-link"><code>R/exceedance.R</code></a></small>
    <div class="hidden name"><code>exceedance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Detect consecutive days in exceedance above or below of a given threshold.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">exceedance</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  x <span class="op">=</span> <span class="va">t</span>,</span>
<span>  y <span class="op">=</span> <span class="va">temp</span>,</span>
<span>  <span class="va">threshold</span>,</span>
<span>  below <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  minDuration <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  joinAcrossGaps <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  maxGap <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  maxPadLength <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  roundRes <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  returnDF <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame with at least the two following columns:
a <code>t</code> column which is a vector of dates of class <code>Date</code>,
and a <code>temp</code> column, which is the temperature on those given
dates. If columns are named differently, their names can be supplied as <code>x</code>
and <code>y</code> (see below). The function will not accurately detect consecutive
days of temperatures in exceedance of the <code>threshold</code> if missing days of
data are not filled in with <code>NA</code>. Data of the appropriate format are created
by the internal function <code><a href="make_whole_fast.html">make_whole_fast</a></code>, but your own data may be used
directly if they meet the given criteria.</p></dd>


<dt>x</dt>
<dd><p>This column is expected to contain a vector of dates as per the
specification of <code>make_whole_fast</code>. If a column headed <code>t</code> is present in
the dataframe, this argument may be omitted; otherwise, specify the name of
the column with dates here.</p></dd>


<dt>y</dt>
<dd><p>This is a column containing the measurement variable. If the column
name differs from the default (i.e. <code>temp</code>), specify the name here.</p></dd>


<dt>threshold</dt>
<dd><p>The static threshold used to determine how many consecutive
days are in exceedance of the temperature of interest.</p></dd>


<dt>below</dt>
<dd><p>Default is <code>FALSE</code>. When set to TRUE, consecutive days of temperature
below the <code>threshold</code> variable are calculated. When set to FALSE,
consecutive days above the <code>threshold</code> variable are calculated.</p></dd>


<dt>minDuration</dt>
<dd><p>Minimum duration that temperatures must be in exceedance
of the <code>threshold</code> variable. The default is <code>5</code> days.</p></dd>


<dt>joinAcrossGaps</dt>
<dd><p>A TRUE/FALSE statement that indicates whether
or not to join consecutive days of temperatures in exceedance of the
<code>threshold</code> across a small gap between groups before/after a short
gap as specified by <code>maxGap</code>. The default is <code>TRUE</code>.</p></dd>


<dt>maxGap</dt>
<dd><p>The maximum length of the gap across which to connect
consecutive days in exceedance of the <code>threshold</code> when
<code>joinAcrossGaps = TRUE</code>.</p></dd>


<dt>maxPadLength</dt>
<dd><p>Specifies the maximum length of days over which to
interpolate (pad) missing data (specified as <code>NA</code>) in the input
temperature time series; i.e., any consecutive blocks of NAs with length
greater than <code>maxPadLength</code> will be left as <code>NA</code>. Set as an
integer. The default is <code>3</code> days.</p></dd>


<dt>roundRes</dt>
<dd><p>This argument allows the user to choose how many decimal places
the exceedance metric outputs will be rounded to. Default is 4. To
prevent rounding set <code>roundRes = FALSE</code>. This argument may only be given
numeric values or FALSE.</p></dd>


<dt>returnDF</dt>
<dd><p>The default (<code>TRUE</code>) tells the function to return the results as
type <code>data.frame</code>. <code>FALSE</code> will return the results as a <code>data.table</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function will return a list of two data.frames.
The first being <code>threshold</code>, which shows the daily temperatures and on which
specific days the given <code>threshold</code> was exceeded. The second component of the
list is <code>exceedance</code>, which shows a medley of statistics for each discrete
group of days in exceedance of the given <code>threshold</code>. Note that any additional
columns left in the data frame given to this function will be output in the
<code>threshold</code> component of the output. For example, if one uses
<code><a href="ts2clm.html">ts2clm</a></code> to prepare a time series for analysis and leaves
in the <code>doy</code> column, this column will appear in the output.</p>


<p>The information shown in the <code>threshold</code> component is:</p>
<dl><dt>t</dt>
<dd><p>The date of the temperature measurement. This variable may named
  differently if an alternative name is supplied to the function's <code>x</code>
  argument.</p></dd>

  <dt>temp</dt>
<dd><p>Temperature on the specified date [deg. C]. This variable may
  named differently if an alternative name is supplied to the function's <code>y</code>
  argument.</p></dd>

  <dt>thresh</dt>
<dd><p>The static <code>threshold</code> chosen by the user [deg. C].</p></dd>

  <dt>thresh_criterion</dt>
<dd><p>Boolean indicating if <code>temp</code> exceeds
  <code>threshold</code>.</p></dd>

  <dt>duration_criterion</dt>
<dd><p>Boolean indicating whether periods of consecutive
  <code>thresh_criterion</code> are &gt;= <code>minDuration</code>.</p></dd>

  <dt>exceedance</dt>
<dd><p>Boolean indicting if all criteria that define a discrete
  group in exceedance of the <code>threshold</code> are met.</p></dd>

  <dt>exceedance_no</dt>
<dd><p>A sequential number indicating the ID and order of
  occurrence of exceedances.</p></dd>


</dl><p>The individual exceedances are summarised using the following metrics:</p>
<dl><dt>exceedance_no</dt>
<dd><p>The same sequential number indicating the ID and
  order of the exceedance as found in the <code>threshold</code> component of the
  output list.</p></dd>

  <dt>index_start</dt>
<dd><p>Row number on which exceedance starts.</p></dd>

  <dt>index_peak</dt>
<dd><p>Row number on which exceedance peaks.</p></dd>

  <dt>index_end</dt>
<dd><p>Row number on which exceedance ends.</p></dd>

  <dt>duration</dt>
<dd><p>Duration of exceedance [days].</p></dd>

  <dt>date_start</dt>
<dd><p>Start date of exceedance [date].</p></dd>

  <dt>date_peak</dt>
<dd><p>Date of exceedance peak [date].</p></dd>

  <dt>date_end</dt>
<dd><p>End date of exceedance [date].</p></dd>

  <dt>intensity_mean</dt>
<dd><p>Mean intensity [deg. C].</p></dd>

  <dt>intensity_max</dt>
<dd><p>Maximum (peak) intensity [deg. C].</p></dd>

  <dt>intensity_var</dt>
<dd><p>Intensity standard deviation [deg. C].</p></dd>

  <dt>intensity_cumulative</dt>
<dd><p>Cumulative intensity [deg. C x days].</p></dd>

  <dt>rate_onset</dt>
<dd><p>Onset rate of exceedance [deg. C / day].</p></dd>

  <dt>rate_decline</dt>
<dd><p>Decline rate of exceedance [deg. C / day].</p></dd>


</dl><p><code>intensity_max_abs</code>, <code>intensity_mean_abs</code>, <code>intensity_var_abs</code>,
and <code>intensity_cum_abs</code> are as above except as absolute magnitudes rather
than relative to the threshold.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    
<ol><li><p>This function assumes that the input time series consists of continuous
daily temperatures, with few missing values. The accompanying function
<code><a href="make_whole_fast.html">make_whole_fast</a></code> aids in the preparation of a time series that is
suitable for use with <code>exceedance</code>, although this may also be accomplished
'by hand' as long as the criteria are met as discussed in the documentation
to <code><a href="make_whole_fast.html">make_whole_fast</a></code>.</p></li>
<li><p>Future versions seek to accommodate monthly and annual time series, too.</p></li>
<li><p>The calculation of onset and decline rates assumes that exceedance of the
<code>threshold</code> started a half-day before the start day and ended a half-day
after the end-day. This is consistent with the duration definition as implemented,
which assumes duration = end day - start day + 1.</p></li>
<li><p>For the purposes of exceedance detection, any missing temperature values not
interpolated over (through optional <code>maxPadLength</code>) will remain as
<code>NA</code>. This means they will trigger the end of an exceedance if the adjacent
temperature values are in exceedance of the <code>threshold</code>.</p></li>
<li><p>If the function is used to detect consecutive days of temperature under
the given <code>theshold</code>, these temperatures are then taken as being in
exceedance below the <code>threshold</code> as there is no antonym in the English
language for 'exceedance'.</p></li>
</ol><p>This function is based largely on the <code>detect_event</code> function found in this
package, which was ported from the Python algorithm that was written by Eric
Oliver, Institute for Marine and Antarctic Studies, University of Tasmania,
Feb 2015, and is documented by Hobday et al. (2016).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robert W. Schlegel, Albertus J. Smit</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">exceedance</span><span class="op">(</span><span class="va">sst_WA</span>, threshold <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in fix.by(by.x, x):</span> 'by' must specify a uniquely valid column</span>
<span class="r-in"><span><span class="co"># show first ten days of daily data:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">threshold</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res' not found</span>
<span class="r-in"><span><span class="co"># show first five exceedances:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">exceedance</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'res' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert W. Schlegel, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2edc7627dae0471f3d765c3355bebbf3',
    indexName: 'heatwaver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

