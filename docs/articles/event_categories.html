<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculating and Visualising Event Categories • heatwaveR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Calculating and Visualising Event Categories">
<meta property="og:description" content="This vignette deomonstrates how to calculate and visualise the categories for events.">
<meta property="og:image" content="https://robwschlegel.github.io/heatwaveR/index.html/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118123016-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118123016-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heatwaveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.2.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/detection_and_visualisation.html">Basic Detection and Visualisation of Events</a>
    </li>
    <li>
      <a href="../articles/event_categories.html">Calculating and Visualising Event Categories</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Calculating and Visualising Exceedances</a>
    </li>
    <li>
      <a href="../articles/complex_clims.html">Alternative Thresholds</a>
    </li>
    <li>
      <a href="../articles/MHW_metric_trends.html">Trend and Breakpoint Analyses</a>
    </li>
    <li>
      <a href="../articles/OISST_preparation.html">Downloading and Preparing OISST Data</a>
    </li>
    <li>
      <a href="../articles/gridded_event_detection.html">Detecting Events in Gridded Data</a>
    </li>
    <li>
      <a href="../articles/Download_SST_v2.html">Download, Prepare, and Analyse Data: Alternative</a>
    </li>
    <li>
      <a href="../articles/MHW_to_nc.html">Saving MHW Results to NetCDF</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://193.50.85.71:3838/demoMHW/" class="external-link">Tutorial</a>
</li>
<li>
  <a href="../CITATIONS.html">Citations</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/robwschlegel/heatwaveR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculating and Visualising Event
Categories</h1>
                        <h4 data-toc-skip class="author">Robert W
Schlegel</h4>
            
            <h4 data-toc-skip class="date">2023-11-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/robwschlegel/heatwaveR/blob/HEAD/vignettes/event_categories.Rmd" class="external-link"><code>vignettes/event_categories.Rmd</code></a></small>
      <div class="hidden name"><code>event_categories.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="categories">Categories<a class="anchor" aria-label="anchor" href="#categories"></a>
</h2>
<p>In Hobday et al. (2018) a naming convention for MHWs was proposed
that divides them into four categories based on their maximum observed
intensity. The naming convention and a brief description are as
follows:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>Category</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>I Moderate</td>
<td>Events that have been detected, but with a maximum intensity that
does not double the distance between the seasonal climatology and the
threshold value. These are common and not terribly worrisome.</td>
</tr>
<tr class="even">
<td>II Strong</td>
<td>Events with a maximum intensity that doubles the distance from the
seasonal climatology to the threshold, but does not triple it. These are
not uncommon, but have yet to be shown to cause any long term biological
or ecological damage.</td>
</tr>
<tr class="odd">
<td>III Severe</td>
<td>Thankfully these are relatively uncommon as they have been linked to
damaging events. The 2003 Mediterranean MHW was this category.</td>
</tr>
<tr class="even">
<td>IV Extreme</td>
<td>Events with a maximum intensity that is four times or greater than
the aforementioned distance. These events are currently rare, but are
projected to increase with frequency. This is troubling as events in
this category are now well documented as causing widespread and lasting
ecological damage. The 2011 Western Australia MHW was this category. It
is also the logo of this package.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="calculating-mhw-categories">Calculating MHW categories<a class="anchor" aria-label="anchor" href="#calculating-mhw-categories"></a>
</h2>
<p>The categories of MHWs under the Hobday et al. (2018) naming scheme
may be calculated with the <strong><code>heatwaveR</code></strong>
package using the <code><a href="../reference/category.html">category()</a></code> function on the output of the
<code><a href="../reference/detect_event.html">detect_event()</a></code> function. By default this function will
order events from most to least intense. Note that one may control the
output for the names of the events by providing ones own character
string for the <code>name</code> argument. Because we have calculated
MHWs on the Western Australia data, we provide the name “WA” below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://robwschlegel.github.io/heatwaveR/index.html">heatwaveR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate events</span></span>
<span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_WA</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MHW</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_event.html">detect_event</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span> </span>
<span><span class="va">MHW_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/category.html">category</a></span><span class="op">(</span><span class="va">MHW</span>, S <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"WA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the top few events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">MHW_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    event_no event_name  peak_date   category  i_max duration p_moderate</span></span>
<span><span class="co">## 85       60   WA 2012b 2012-12-31  II Strong 3.4230       14         64</span></span>
<span><span class="co">## 86       29    WA 1999 1999-05-22  II Strong 3.6390       95         63</span></span>
<span><span class="co">## 87       47    WA 2009 2009-03-25  II Strong 2.3773        7         57</span></span>
<span><span class="co">## 88       72    WA 2015 2015-10-02  II Strong 2.4604        7         57</span></span>
<span><span class="co">## 89       41   WA 2008a 2008-04-14 III Severe 3.8299       35         57</span></span>
<span><span class="co">## 90       52   WA 2011a 2011-02-28 IV Extreme 6.5798      105         52</span></span>
<span><span class="co">##    p_strong p_severe p_extreme        season</span></span>
<span><span class="co">## 85       36        0         0 Spring/Summer</span></span>
<span><span class="co">## 86       37        0         0   Fall/Winter</span></span>
<span><span class="co">## 87       43        0         0        Summer</span></span>
<span><span class="co">## 88       43        0         0 Winter/Spring</span></span>
<span><span class="co">## 89       23       17         0   Summer/Fall</span></span>
<span><span class="co">## 90       27       11        10   Spring-Fall</span></span></code></pre>
<p>Note that this functions expects the data to have been collected in
the southern hemisphere, hence the argument <code>S = TRUE</code>. If
they were not, one must set <code>S = FALSE</code> as seen in the
example below. This ensures that the correct seasons are attributed to
the event.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_Med</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_event.html">detect_event</a></span><span class="op">(</span><span class="fu"><a href="../reference/ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_Med</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_Med_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/category.html">category</a></span><span class="op">(</span><span class="va">res_Med</span>, S <span class="op">=</span> <span class="cn">FALSE</span>, name <span class="op">=</span> <span class="st">"Med"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">res_Med_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     event_no event_name  peak_date   category  i_max duration p_moderate</span></span>
<span><span class="co">## 118       98  Med 2018b 2018-08-04  II Strong 4.7451       44         52</span></span>
<span><span class="co">## 119      123  Med 2022c 2022-11-03  II Strong 3.5030       74         46</span></span>
<span><span class="co">## 120       67  Med 2012b 2012-08-20  II Strong 4.3190       18         44</span></span>
<span><span class="co">## 121       46  Med 2007c 2007-04-25 III Severe 4.0467       19         42</span></span>
<span><span class="co">## 122       75   Med 2014 2014-10-18  II Strong 3.3443      144         39</span></span>
<span><span class="co">## 123       96  Med 2018a 2018-04-28  II Strong 3.3185       11         27</span></span>
<span><span class="co">##     p_strong p_severe p_extreme        season</span></span>
<span><span class="co">## 118       48        0         0        Summer</span></span>
<span><span class="co">## 119       53        0         0          Fall</span></span>
<span><span class="co">## 120       56        0         0        Summer</span></span>
<span><span class="co">## 121       53        5         0        Spring</span></span>
<span><span class="co">## 122       60        0         0 Summer-Winter</span></span>
<span><span class="co">## 123       73        0         0        Spring</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="multiple-time-series">Multiple time series<a class="anchor" aria-label="anchor" href="#multiple-time-series"></a>
</h2>
<p>If however we may want to determine the categories of event within a
set of time series that cross over the equator, we may set the argument
<code>lat_col = TRUE</code> to allow <code><a href="../reference/category.html">category()</a></code> to
automagically detect the latitude of the events by searching for columns
named either ‘lat’ or ’latitude. See the vignette for <a href="https://robwschlegel.github.io/heatwaveR/articles/gridded_event_detection.html" class="external-link">detecting
events in gridded data</a> for more examples of running
<strong><code>heatwaveR</code></strong> code on gridded data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add lon/lat to the three default time series</span></span>
<span><span class="va">ts_WA</span> <span class="op">&lt;-</span> <span class="va">sst_WA</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"WA"</span>, lon <span class="op">=</span> <span class="fl">112.625</span>, lat <span class="op">=</span> <span class="op">-</span><span class="fl">29.375</span><span class="op">)</span></span>
<span><span class="va">ts_NW_Atl</span> <span class="op">&lt;-</span> <span class="va">sst_NW_Atl</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"NW_Atl"</span>, lon <span class="op">=</span> <span class="op">-</span><span class="fl">66.875</span>, lat <span class="op">=</span> <span class="fl">43.125</span><span class="op">)</span></span>
<span><span class="va">ts_Med</span> <span class="op">&lt;-</span> <span class="va">sst_Med</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"Med"</span>, lon <span class="op">=</span> <span class="fl">9.125</span>, lat <span class="op">=</span> <span class="fl">43.625</span><span class="op">)</span></span>
<span><span class="va">ts_ALL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ts_WA</span>, <span class="va">ts_NW_Atl</span>, <span class="va">ts_Med</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate MHW categories by site</span></span>
<span><span class="va">MHW_cat_ALL</span> <span class="op">&lt;-</span> <span class="va">ts_ALL</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="op">{</span></span>
<span>    <span class="va">.x</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/ts2clm.html">ts2clm</a></span><span class="op">(</span>climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/detect_event.html">detect_event</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/category.html">category</a></span><span class="op">(</span>season <span class="op">=</span> <span class="st">"peak"</span>, lat_col <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Correct event names by site</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>event_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">event_name</span><span class="op">)</span> <span class="op">~</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span><span class="va">event_name</span>, <span class="st">"Event"</span>, <span class="va">site</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="va">MHW_cat_ALL</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">duration</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">event_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">site</span><span class="op">:</span><span class="va">category</span>, <span class="va">duration</span>, <span class="va">season</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   site [3]</span></span></span>
<span><span class="co">##   site   event_no event_name   peak_date  category   duration season</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Med          75 Med 2014     2014-10-18 II Strong       144 Fall  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Med         122 Med 2022b    2022-07-20 II Strong        79 Summer</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> NW_Atl       72 NW_Atl 2012c 2012-07-15 II Strong       239 Summer</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NW_Atl      100 NW_Atl 2018a 2018-01-12 III Severe      171 Winter</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> WA           52 WA 2011a     2011-02-28 IV Extreme      105 Summer</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> WA           59 WA 2012a     2012-01-27 II Strong       101 Summer</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualising-mhw-categories">Visualising MHW categories<a class="anchor" aria-label="anchor" href="#visualising-mhw-categories"></a>
</h2>
<div class="section level3">
<h3 id="default-mhw-category-visuals">Default MHW category visuals<a class="anchor" aria-label="anchor" href="#default-mhw-category-visuals"></a>
</h3>
<p>A quick and easy visualisation of the categories of a MHW may be
accomplished with <code><a href="../reference/event_line.html">event_line()</a></code> by setting the
<code>category</code> argument to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/event_line.html">event_line</a></span><span class="op">(</span><span class="va">MHW</span>, spread <span class="op">=</span> <span class="fl">100</span>, start_date <span class="op">=</span> <span class="st">"2010-11-01"</span>, end_date <span class="op">=</span> <span class="st">"2011-06-30"</span>, category <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_categories_files/figure-html/fig-example-1-1.png" width="768"><!-- ![](vignettes/fig-example-10-1.png) --></p>
</div>
<div class="section level3">
<h3 id="custom-mhw-category-visuals">Custom MHW category visuals<a class="anchor" aria-label="anchor" href="#custom-mhw-category-visuals"></a>
</h3>
<p>Were one to want to visualise the categories of a MHW ‘by hand’, the
following code will provide a good starting point.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create category breaks and select slice of data.frame</span></span>
<span><span class="va">clim_cat</span> <span class="op">&lt;-</span> <span class="va">MHW</span><span class="op">$</span><span class="va">clim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">thresh</span> <span class="op">-</span> <span class="va">seas</span>,</span>
<span>                thresh_2x <span class="op">=</span> <span class="va">thresh</span> <span class="op">+</span> <span class="va">diff</span>,</span>
<span>                thresh_3x <span class="op">=</span> <span class="va">thresh_2x</span> <span class="op">+</span> <span class="va">diff</span>,</span>
<span>                thresh_4x <span class="op">=</span> <span class="va">thresh_3x</span> <span class="op">+</span> <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">10580</span><span class="op">:</span><span class="fl">10690</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set line colours</span></span>
<span><span class="va">lineColCat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Temperature"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="st">"Climatology"</span> <span class="op">=</span> <span class="st">"gray20"</span>,</span>
<span>  <span class="st">"Threshold"</span> <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>  <span class="st">"2x Threshold"</span> <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>  <span class="st">"3x Threshold"</span> <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>  <span class="st">"4x Threshold"</span> <span class="op">=</span> <span class="st">"darkgreen"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Set category fill colours</span></span>
<span><span class="va">fillColCat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Moderate"</span> <span class="op">=</span> <span class="st">"#ffc866"</span>,</span>
<span>  <span class="st">"Strong"</span> <span class="op">=</span> <span class="st">"#ff6900"</span>,</span>
<span>  <span class="st">"Severe"</span> <span class="op">=</span> <span class="st">"#9e0000"</span>,</span>
<span>  <span class="st">"Extreme"</span> <span class="op">=</span> <span class="st">"#2d0000"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clim_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="va">thresh</span>, fill <span class="op">=</span> <span class="st">"Moderate"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="va">thresh_2x</span>, fill <span class="op">=</span> <span class="st">"Strong"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="va">thresh_3x</span>, fill <span class="op">=</span> <span class="st">"Severe"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="va">thresh_4x</span>, fill <span class="op">=</span> <span class="st">"Extreme"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_2x</span>, col <span class="op">=</span> <span class="st">"2x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_3x</span>, col <span class="op">=</span> <span class="st">"3x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dotdash"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_4x</span>, col <span class="op">=</span> <span class="st">"4x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">seas</span>, col <span class="op">=</span> <span class="st">"Climatology"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh</span>, col <span class="op">=</span> <span class="st">"Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">temp</span>, col <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="va">lineColCat</span>,</span>
<span>                      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temperature"</span>, <span class="st">"Climatology"</span>, <span class="st">"Threshold"</span>,</span>
<span>                                 <span class="st">"2x Threshold"</span>, <span class="st">"3x Threshold"</span>, <span class="st">"4x Threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="va">fillColCat</span>, guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"solid"</span>, <span class="st">"solid"</span>,</span>
<span>                                                                <span class="st">"dashed"</span>, <span class="st">"dotdash"</span>, <span class="st">"dotted"</span><span class="op">)</span>,</span>
<span>                                                   size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature [°C]"</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_categories_files/figure-html/fig-example-2-1.png" width="768"><!-- ![](vignettes/fig-example-11-1.png) --></p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-mcs-categories">Calculating MCS categories<a class="anchor" aria-label="anchor" href="#calculating-mcs-categories"></a>
</h2>
<p>MCSs are calculated the same as for MHWs. The <code><a href="../reference/category.html">category()</a></code>
function will automagically detect if it has been fed MHWs or MCSs so no
additional arguments are required. For the sake of clarity the following
code chunks demonstrates how to calculate MCS categories.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate events</span></span>
<span><span class="va">ts_MCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts2clm.html">ts2clm</a></span><span class="op">(</span><span class="va">sst_WA</span>, climatologyPeriod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span><span class="op">)</span>, pctile <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">MCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detect_event.html">detect_event</a></span><span class="op">(</span><span class="va">ts_MCS</span>, coldSpells <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">MCS_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/category.html">category</a></span><span class="op">(</span><span class="va">MCS</span>, S <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"WA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the top few events</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">MCS_cat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    event_no event_name  peak_date  category   i_max duration p_moderate</span></span>
<span><span class="co">## 81       77   WA 2018a 2018-08-02 II Strong -2.4311       46         67</span></span>
<span><span class="co">## 82       40    WA 2000 2000-08-13 II Strong -2.2743       11         64</span></span>
<span><span class="co">## 83       15    WA 1990 1990-05-11 II Strong -3.1883       76         62</span></span>
<span><span class="co">## 84       53    WA 2005 2005-10-16 II Strong -1.8637       13         62</span></span>
<span><span class="co">## 85       83    WA 2020 2020-05-25 II Strong -3.1433       41         61</span></span>
<span><span class="co">## 86       11    WA 1987 1987-12-10 II Strong -2.4968        9         44</span></span>
<span><span class="co">##    p_strong p_severe p_extreme season</span></span>
<span><span class="co">## 81       33        0         0 Winter</span></span>
<span><span class="co">## 82       36        0         0 Winter</span></span>
<span><span class="co">## 83       38        0         0   Fall</span></span>
<span><span class="co">## 84       38        0         0 Spring</span></span>
<span><span class="co">## 85       39        0         0   Fall</span></span>
<span><span class="co">## 86       56        0         0 Spring</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualising-mcs-categories">Visualising MCS categories<a class="anchor" aria-label="anchor" href="#visualising-mcs-categories"></a>
</h2>
<div class="section level3">
<h3 id="default-mcs-category-visuals">Default MCS category visuals<a class="anchor" aria-label="anchor" href="#default-mcs-category-visuals"></a>
</h3>
<p>The <code><a href="../reference/event_line.html">event_line()</a></code> function also works for visualising MCS
categories. The function will automagically detect that it is being fed
MCSs so we do not need to provide it with any new arguments. Note that
the colour palette for MCS does have four colours, same as for MHWs, but
none of the demo time series that come packaged with
<strong><code>heatwaveR</code></strong> have MCSs that intense so we are
not able to demonstrate the full colour palette here.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/event_line.html">event_line</a></span><span class="op">(</span><span class="va">MCS</span>, spread <span class="op">=</span> <span class="fl">100</span>, start_date <span class="op">=</span> <span class="st">"1989-11-01"</span>, end_date <span class="op">=</span> <span class="st">"1990-06-30"</span>, category <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_categories_files/figure-html/fig-example-3-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="custom-mcs-category-visuals">Custom MCS category visuals<a class="anchor" aria-label="anchor" href="#custom-mcs-category-visuals"></a>
</h3>
<p>The following code chunk demonstrates how to manually create a figure
showing the MCS categories.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create category breaks and select slice of data.frame</span></span>
<span><span class="va">MCS_clim_cat</span> <span class="op">&lt;-</span> <span class="va">MCS</span><span class="op">$</span><span class="va">clim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">thresh</span> <span class="op">-</span> <span class="va">seas</span>,</span>
<span>                thresh_2x <span class="op">=</span> <span class="va">thresh</span> <span class="op">+</span> <span class="va">diff</span>,</span>
<span>                thresh_3x <span class="op">=</span> <span class="va">thresh_2x</span> <span class="op">+</span> <span class="va">diff</span>,</span>
<span>                thresh_4x <span class="op">=</span> <span class="va">thresh_3x</span> <span class="op">+</span> <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">2910</span><span class="op">:</span><span class="fl">3150</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set line colours</span></span>
<span><span class="va">lineColCat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Temperature"</span> <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="st">"Climatology"</span> <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>  <span class="st">"Threshold"</span> <span class="op">=</span> <span class="st">"darkorchid"</span>,</span>
<span>  <span class="st">"2x Threshold"</span> <span class="op">=</span> <span class="st">"darkorchid"</span>,</span>
<span>  <span class="st">"3x Threshold"</span> <span class="op">=</span> <span class="st">"darkorchid"</span>,</span>
<span>  <span class="st">"4x Threshold"</span> <span class="op">=</span> <span class="st">"darkorchid"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Set category fill colours</span></span>
<span><span class="va">fillColCat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Moderate"</span> <span class="op">=</span> <span class="st">"#C7ECF2"</span>,</span>
<span>  <span class="st">"Strong"</span> <span class="op">=</span> <span class="st">"#85B7CC"</span>,</span>
<span>  <span class="st">"Severe"</span> <span class="op">=</span> <span class="st">"#4A6A94"</span>,</span>
<span>  <span class="st">"Extreme"</span> <span class="op">=</span> <span class="st">"#111433"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MCS_clim_cat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh</span>, y2 <span class="op">=</span> <span class="va">temp</span>, fill <span class="op">=</span> <span class="st">"Moderate"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_2x</span>, y2 <span class="op">=</span> <span class="va">temp</span>, fill <span class="op">=</span> <span class="st">"Strong"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_3x</span>, y2 <span class="op">=</span> <span class="va">temp</span>, fill <span class="op">=</span> <span class="st">"Severe"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_flame.html">geom_flame</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_4x</span>, y2 <span class="op">=</span> <span class="va">temp</span>, fill <span class="op">=</span> <span class="st">"Extreme"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_2x</span>, col <span class="op">=</span> <span class="st">"2x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_3x</span>, col <span class="op">=</span> <span class="st">"3x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dotdash"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh_4x</span>, col <span class="op">=</span> <span class="st">"4x Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">seas</span>, col <span class="op">=</span> <span class="st">"Climatology"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">thresh</span>, col <span class="op">=</span> <span class="st">"Threshold"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">temp</span>, col <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="va">lineColCat</span>,</span>
<span>                      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Temperature"</span>, <span class="st">"Climatology"</span>, <span class="st">"Threshold"</span>,</span>
<span>                                 <span class="st">"2x Threshold"</span>, <span class="st">"3x Threshold"</span>, <span class="st">"4x Threshold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, values <span class="op">=</span> <span class="va">fillColCat</span>, guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"solid"</span>, <span class="st">"solid"</span>,</span>
<span>                                                                <span class="st">"dashed"</span>, <span class="st">"dotdash"</span>, <span class="st">"dotted"</span><span class="op">)</span>,</span>
<span>                                                   size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature [°C]"</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_categories_files/figure-html/fig-example-4-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="category-colour-palettes">Category colour palettes<a class="anchor" aria-label="anchor" href="#category-colour-palettes"></a>
</h2>
<p>For the sake of convenience the MHW and MCS colour palettes are
provided below with a figure showing the direct comparison.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The MCS colour palette</span></span>
<span><span class="va">MCS_colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Moderate"</span> <span class="op">=</span> <span class="st">"#C7ECF2"</span>,</span>
<span>  <span class="st">"Strong"</span> <span class="op">=</span> <span class="st">"#85B7CC"</span>,</span>
<span>  <span class="st">"Severe"</span> <span class="op">=</span> <span class="st">"#4A6A94"</span>,</span>
<span>  <span class="st">"Extreme"</span> <span class="op">=</span> <span class="st">"#111433"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The MHW colour palette</span></span>
<span><span class="va">MHW_colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Moderate"</span> <span class="op">=</span> <span class="st">"#ffc866"</span>,</span>
<span>  <span class="st">"Strong"</span> <span class="op">=</span> <span class="st">"#ff6900"</span>,</span>
<span>  <span class="st">"Severe"</span> <span class="op">=</span> <span class="st">"#9e0000"</span>,</span>
<span>  <span class="st">"Extreme"</span> <span class="op">=</span> <span class="st">"#2d0000"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the colour palette for plotting by itself</span></span>
<span><span class="va">colour_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I Moderate"</span>, <span class="st">"II Strong"</span>, <span class="st">"III Severe"</span>, <span class="st">"IV Extreme"</span><span class="op">)</span>,</span>
<span>                                               levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I Moderate"</span>, <span class="st">"II Strong"</span>, <span class="st">"III Severe"</span>, <span class="st">"IV Extreme"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             MHW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">MHW_colours</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">MHW_colours</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">MHW_colours</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">MHW_colours</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                             MCS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">MCS_colours</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">MCS_colours</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">MCS_colours</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">MCS_colours</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">MHW</span>, <span class="va">MCS</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"event"</span>, values_to <span class="op">=</span> <span class="st">"colour"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the palettes side-by-side</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">colour_palette</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span>, y <span class="op">=</span> <span class="va">event</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">colour_palette</span><span class="op">$</span><span class="va">colour</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="event_categories_files/figure-html/comp-fig-1.png" width="768"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert W. Schlegel, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2edc7627dae0471f3d765c3355bebbf3',
    indexName: 'heatwaver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
